/**
 * @file Firestore Security Rules
 * @description This ruleset secures the contactFormSubmissions collection, ensuring only authenticated users can submit contact forms.
 *
 * Core Philosophy:
 *  This ruleset prioritizes protecting the contact form submissions from unauthorized access. It assumes submissions should be publicly readable but only creatable by authenticated users.
 *
 * Data Structure:
 *  All contact form submission data is stored in the /contactFormSubmissions/{contactFormSubmissionId} collection.
 *
 * Key Security Decisions:
 *  - Write access to the /contactFormSubmissions collection is restricted to authenticated users.
 *  - Read access to the /contactFormSubmissions collection is open to all.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Controls access to the contactFormSubmissions collection, allowing authenticated users to create submissions.
     * @path /contactFormSubmissions/{contactFormSubmissionId}
     * @allow (create) User is authenticated and creating a new contact form submission.
     *   request.auth.uid != null
     * @deny (create) User is not authenticated.
     *   request.auth.uid == null
     * @principle Allows only authenticated users to create contact form submissions.
     */
    match /contactFormSubmissions/{contactFormSubmissionId} {
      allow get: if true;
      allow list: if true;
      allow create: if isSignedIn();
      allow update: if false;
      allow delete: if false;
    }

    function isSignedIn() {
      return request.auth != null;
    }
  }
}